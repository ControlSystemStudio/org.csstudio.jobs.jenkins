# CS-Studio Jenkins Build Job
#
# Jenkins Job Builder configuration template
#

- job-template:
    name: 'cs-studio-{top}-{module}-{version}'
    defaults: build-defaults

    project-type: maven
    description: |
        <h2>Build {module} ({language}) from its GitHub repo.</h2>
        {generated-job-warning}

    block-upstream: true

    scm:
        - git:
            url: https://github.com/ControlSystemStudio/cs-studio.git
            branches:
                - '{version}'
            included-regions:
                - '{top}/{module}/.*'
                - '{top}/pom.xml'
            skip-tag: true
            sparse-checkout:
                paths:
                    - '{top}/{module}'
                    - '{top}/pom.xml'
                    - 'build/cs-studio-jenkins-checkstyle'
            shallow-clone: true

    triggers:
        - github

    maven:
       maven-name: Maven 3.0.4
       root-pom: '{top}/{module}/pom.xml'
       goals: clean verify -Declipse.p2.mirrors=false -Dtycho.localArtifacts=ignore -PuploadRepo -Pcheckstyle
       settings: org.jenkinsci.plugins.configfiles.maven.MavenSettingsConfig1360703118225

    publishers:
        - email:
            recipients: '{email-notify}'
            send-to-individuals: true
        - checkstyle
